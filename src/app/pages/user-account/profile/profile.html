<div class="space-y-6">
  <!-- Profile Header -->
  <div class="bg-white rounded-lg shadow-md p-4 sm:p-6">
    <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between space-y-4 sm:space-y-0">
      <div
        class="flex flex-col sm:flex-row items-center sm:items-start space-y-4 sm:space-y-0 sm:space-x-4"
      >
        <!-- Avatar -->
        <div
          class="w-20 h-20 bg-linear-to-br from-amber-600 to-amber-700 rounded-full flex items-center justify-center text-white text-2xl font-bold shadow-lg"
        >
          {{ authService.getUserInitials() }}
        </div>

        <!-- User Info -->
        <div class="text-center sm:text-left">
          <div
            class="flex flex-col sm:flex-row items-center sm:items-center space-y-2 sm:space-y-0 sm:space-x-2"
          >
            <h2 class="text-xl sm:text-2xl font-bold text-gray-800">
              {{ user()!.name | shortename }}
            </h2>
            @if (user()!.membershipType === 'gold') {
              <span class="bg-amber-100 text-amber-700 text-xs font-semibold px-2 py-1 rounded">
                <i class="fa-solid fa-crown"></i> Gold Member
              </span>
            }
          </div>
          <p class="text-gray-600 text-sm mt-1">Member since {{ user()!.memberSince }}</p>

          <!-- Stats -->
          <div class="flex items-center justify-center sm:justify-start space-x-6 mt-3">
            <div class="text-center sm:text-left">
              <p class="text-xs text-gray-500">TOTAL ORDERS</p>
              <p class="text-lg font-bold text-gray-800">{{ user()!.totalOrders }}</p>
            </div>
            <div class="text-center sm:text-left">
              <p class="text-xs text-gray-500">REVIEWS</p>
              <p class="text-lg font-bold text-gray-800">{{ user()!.totalReviews }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Edit Button -->
      <button
        (click)="toggleEditMode()"
        class="self-center sm:self-start text-amber-700 hover:text-amber-800 transition-colors"
      >
        <i
          [class]="isEditingProfile() ? 'fa-solid fa-xmark text-xl' : 'fa-solid fa-pen text-lg'"
        ></i>
      </button>
    </div>
  </div>

  <!-- Personal Information -->
  <div class="bg-white rounded-lg shadow-md p-4 sm:p-6">
    <div
      class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 space-y-2 sm:space-y-0"
    >
      <h3 class="text-lg sm:text-xl font-bold text-gray-800">Personal Information</h3>
      @if (!isEditingProfile()) {
        <button
          (click)="toggleEditMode()"
          class="text-amber-700 hover:text-amber-800 text-sm font-semibold transition-colors"
        >
          Edit details
        </button>
      }
    </div>

    @if (saveMessage()) {
      <div class="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
        <p class="text-green-600 text-sm">{{ saveMessage() }}</p>
      </div>
    }

    <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
        <!-- First Name -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">First Name</label>
          <input
            type="text"
            formControlName="firstName"
            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 disabled:bg-gray-50 disabled:text-gray-600 transition-all"
          />
          @if (hasError('profile', 'firstName', 'required')) {
            <p class="text-red-500 text-xs mt-1">First name is required</p>
          }
        </div>

        <!-- Last Name -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">Last Name</label>
          <input
            type="text"
            formControlName="lastName"
            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 disabled:bg-gray-50 disabled:text-gray-600 transition-all"
          />
          @if (hasError('profile', 'lastName', 'required')) {
            <p class="text-red-500 text-xs mt-1">Last name is required</p>
          }
        </div>
      </div>

      <!-- Email -->
      <div class="mb-4">
        <label class="block text-sm font-semibold text-gray-700 mb-2">Email Address</label>
        <div class="relative">
          <i
            class="fa-solid fa-envelope absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
          ></i>
          <input
            type="email"
            formControlName="email"
            class="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 disabled:bg-gray-50 disabled:text-gray-600 transition-all"
          />
        </div>
        @if (hasError('profile', 'email', 'email')) {
          <p class="text-red-500 text-xs mt-1">Invalid email format</p>
        }
      </div>

      <!-- Phone -->
      <div class="mb-4">
        <label class="block text-sm font-semibold text-gray-700 mb-2">Phone Number</label>
        <div class="relative">
          <i class="fa-solid fa-phone absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
          <input
            type="tel"
            formControlName="phone"
            class="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 disabled:bg-gray-50 disabled:text-gray-600 transition-all"
          />
        </div>
      </div>

      <!-- Save Button -->
      @if (isEditingProfile()) {
        <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3">
          <button
            type="submit"
            class="flex-1 bg-amber-600 text-white py-2 px-4 rounded-lg hover:bg-amber-700 transition-colors disabled:opacity-50 font-semibold"
          >
            @if (isSavingProfile()) {
              <i class="fa-solid fa-spinner fa-spin mr-2"></i>
              <span>Saving...</span>
            } @else {
              <span>Save Changes</span>
            }
          </button>
          <button
            type="button"
            (click)="toggleEditMode()"
            class="px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-semibold"
          >
            Cancel
          </button>
        </div>
      }
    </form>
  </div>
</div>
